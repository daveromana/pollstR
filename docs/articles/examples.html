<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Pollster Examples â€¢ pollstR</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script><script src="../pkgdown.js"></script><!-- mathjax --><script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-vignette">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">pollstR</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../articles/index.html">Articles</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/rOpenGov/pollstR">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9">
    <div class="page-header toc-ignore">
      <h1>Pollster Examples</h1>
                        <h4 class="author">Jeffrey Arnold</h4>
            
          </div>

    
    
<div class="contents">
<p>This document provides a few examples that use the <strong>pollstR</strong> package.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(<span class="st">"pollstR"</span>)
<span class="kw">library</span>(<span class="st">"tidyverse"</span>)</code></pre></div>
<pre><code>## Loading tidyverse: ggplot2
## Loading tidyverse: tibble
## Loading tidyverse: tidyr
## Loading tidyverse: readr
## Loading tidyverse: purrr
## Loading tidyverse: dplyr</code></pre>
<pre><code>## Conflicts with tidy packages ----------------------------------------------</code></pre>
<pre><code>## filter():  dplyr, stats
## is_null(): purrr, testthat
## lag():     dplyr, stats
## matches(): dplyr, testthat</code></pre>
<div id="produce-a-plot-of-chart" class="section level1">
<h1 class="hasAnchor">
<html><body><a href="#produce-a-plot-of-chart" class="anchor"> </a></body></html>Produce a Plot of Chart</h1>
<p>The <strong>pollstR</strong> package can be used to reproduce plots in the charts. This will use the Donald Trump favorable rating as the example. This chart has the slug <a href="http://elections.huffingtonpost.com/pollster/donald-trump-favorable-rating">donald-trump-favorable-rating</a></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">slug &lt;-<span class="st"> "donald-trump-favorable-rating"</span>
polls &lt;-<span class="st"> </span><span class="kw"><a href="../reference/pollster_api.html">pollster_charts_polls</a></span>(slug)[[<span class="st">"content"</span>]]
trendlines &lt;-<span class="st"> </span><span class="kw"><a href="../reference/pollster_api.html">pollster_charts_trendlines</a></span>(slug)[[<span class="st">"content"</span>]]</code></pre></div>
<p>Plot the points for each response (Favorable, Unfavorable, and Undecided) and fit a loess smoother through them:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">.data &lt;-<span class="st"> </span><span class="kw">gather</span>(polls, response, value,
                Favorable, Unfavorable, Undecided) %&gt;%
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">value =</span> <span class="kw">if_else</span>(<span class="kw">is.na</span>(value), <span class="dv">0</span>, value))
<span class="kw">ggplot</span>() +
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> .data,
             <span class="kw">aes</span>(<span class="dt">x =</span> end_date, <span class="dt">y =</span> value, <span class="dt">color =</span> response),
             <span class="dt">alpha =</span> <span class="fl">0.5</span>) +
<span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">data =</span> .data, <span class="dt">method =</span> <span class="st">"loess"</span>, <span class="dt">se =</span> <span class="ot">FALSE</span>,
              <span class="kw">aes</span>(<span class="dt">x =</span> end_date, <span class="dt">y =</span> value, <span class="dt">color =</span> response))</code></pre></div>
<p><img src="examples_files/figure-html/unnamed-chunk-3-1.png" width="672"> Plot the points with the Pollster trendlines:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>() +
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> .data,
             <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> end_date, <span class="dt">y =</span> value, <span class="dt">color =</span> response),
             <span class="dt">alpha =</span> <span class="fl">0.5</span>) +
<span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">data =</span> trendlines,
            <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> date, <span class="dt">y =</span> value, <span class="dt">color =</span> label), <span class="dt">size =</span> <span class="fl">1.5</span>)</code></pre></div>
<p><img src="examples_files/figure-html/unnamed-chunk-4-1.png" width="672"></p>
<p>For each of the subpopulations (Likely Voter, Registered Voters, Adults), plot the favorability rating:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> <span class="kw">filter</span>(.data, response ==<span class="st"> "Favorable"</span>),
       <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> end_date, <span class="dt">y =</span> value, <span class="dt">color =</span> sample_subpopulation)) +
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">alpha =</span> <span class="fl">0.5</span>) +
<span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">"loess"</span>, <span class="dt">se =</span> <span class="ot">FALSE</span>)</code></pre></div>
<p><img src="examples_files/figure-html/unnamed-chunk-5-1.png" width="672"></p>
</div>
<div id="questions" class="section level1">
<h1 class="hasAnchor">
<html><body><a href="#questions" class="anchor"> </a></body></html>Questions</h1>
<p>An example of a single question item:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">questions &lt;-<span class="st"> </span><span class="kw"><a href="../reference/pollster_api.html">pollster_questions</a></span>()
questions$content$items[[<span class="dv">1</span>]]</code></pre></div>
<pre><code>## $slug
## [1] "17-VA-Gov-GE-RvP"
## 
## $name
## [1] "2017 Virginia Gubernatorial GE"
## 
## $tags
## list()
## 
## $charts
## list()
## 
## $election_date
## NULL
## 
## $n_polls
## [1] 1
## 
## $created_at
## [1] "2017-02-16T18:23:56.000Z"
## 
## $responses
## $responses[[1]]
## $responses[[1]]$label
## [1] "Riggleman"
## 
## $responses[[1]]$name
## [1] "Denver Riggleman"
## 
## $responses[[1]]$party
## [1] "Republican"
## 
## $responses[[1]]$incumbent
## [1] FALSE
## 
## 
## $responses[[2]]
## $responses[[2]]$label
## [1] "Perriello"
## 
## $responses[[2]]$name
## [1] "Tom Perriello"
## 
## $responses[[2]]$party
## [1] "Democrat"
## 
## $responses[[2]]$incumbent
## [1] FALSE
## 
## 
## $responses[[3]]
## $responses[[3]]$label
## [1] "Other"
## 
## $responses[[3]]$name
## [1] "Other"
## 
## $responses[[3]]$party
## NULL
## 
## $responses[[3]]$incumbent
## [1] FALSE
## 
## 
## $responses[[4]]
## $responses[[4]]$label
## [1] "Undecided"
## 
## $responses[[4]]$name
## [1] "Undecided"
## 
## $responses[[4]]$party
## NULL
## 
## $responses[[4]]$incumbent
## [1] FALSE</code></pre>
</div>
<div id="charts" class="section level1">
<h1 class="hasAnchor">
<html><body><a href="#charts" class="anchor"> </a></body></html>Charts</h1>
<p>An example of a single chart item:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">charts &lt;-<span class="st"> </span><span class="kw"><a href="../reference/pollster_api.html">pollster_charts</a></span>()
charts$content$items[[<span class="dv">1</span>]]</code></pre></div>
<pre><code>## $slug
## [1] "trump-job-approval"
## 
## $title
## [1] "Trump Job Approval"
## 
## $url
## [1] "http://elections.huffingtonpost.com/pollster/trump-job-approval"
## 
## $created_at
## [1] "2017-02-17T20:12:19.000Z"
## 
## $tags
## list()
## 
## $pollster_estimates
## $pollster_estimates[[1]]
## $pollster_estimates[[1]]$algorithm
## [1] "lowess"
## 
## $pollster_estimates[[1]]$created_at
## [1] "2017-02-20T04:41:11.673Z"
## 
## $pollster_estimates[[1]]$datetime
## [1] "2017-02-17T20:12:19.000Z"
## 
## $pollster_estimates[[1]]$values
## $pollster_estimates[[1]]$values$item_name
## [1] "value"
## 
## $pollster_estimates[[1]]$values$key_name
## [1] "label"
## 
## $pollster_estimates[[1]]$values$hash
## $pollster_estimates[[1]]$values$hash$Approve
## [1] 44.6073
## 
## $pollster_estimates[[1]]$values$hash$Disapprove
## [1] 50.5299
## 
## $pollster_estimates[[1]]$values$hash$Undecided
## [1] 5.4944
## 
## 
## 
## $pollster_estimates[[1]]$lowess_parameters
## $pollster_estimates[[1]]$lowess_parameters$f
## [1] 0.7
## 
## $pollster_estimates[[1]]$lowess_parameters$iter
## [1] 3
## 
## $pollster_estimates[[1]]$lowess_parameters$delta
## [1] 0.01
## 
## 
## 
## 
## $pollster_estimate_summary
## NULL
## 
## $question
## $question$slug
## [1] "00c -Pres-45-Trump - Job Approval - National"
## 
## $question$name
## [1] "Trump, Donald - USPres - Job Approval"
## 
## $question$tags
## list()
## 
## $question$charts
## $question$charts[[1]]
## [1] "trump-job-approval"
## 
## 
## $question$election_date
## NULL
## 
## $question$n_polls
## [1] 69
## 
## $question$created_at
## [1] "2017-01-10T18:32:55.000Z"
## 
## $question$responses
## $question$responses[[1]]
## $question$responses[[1]]$label
## [1] "Approve"
## 
## $question$responses[[1]]$name
## [1] "Approve"
## 
## $question$responses[[1]]$party
## NULL
## 
## $question$responses[[1]]$incumbent
## [1] FALSE
## 
## 
## $question$responses[[2]]
## $question$responses[[2]]$label
## [1] "Disapprove"
## 
## $question$responses[[2]]$name
## [1] "Disapprove"
## 
## $question$responses[[2]]$party
## NULL
## 
## $question$responses[[2]]$incumbent
## [1] FALSE
## 
## 
## $question$responses[[3]]
## $question$responses[[3]]$label
## [1] "Undecided"
## 
## $question$responses[[3]]$name
## [1] "Undecided"
## 
## $question$responses[[3]]$party
## NULL
## 
## $question$responses[[3]]$incumbent
## [1] FALSE</code></pre>
</div>
<div id="polls" class="section level1">
<h1 class="hasAnchor">
<html><body><a href="#polls" class="anchor"> </a></body></html>Polls</h1>
<p>An example of a single poll item:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">polls &lt;-<span class="st"> </span><span class="kw"><a href="../reference/pollster_api.html">pollster_polls</a></span>()
polls$content$items[[<span class="dv">1</span>]]</code></pre></div>
<pre><code>## $slug
## [1] "gallup-27126"
## 
## $start_date
## [1] "2017-02-14"
## 
## $end_date
## [1] "2017-02-16"
## 
## $created_at
## [1] "2017-02-17T23:54:51.000Z"
## 
## $updated_at
## [1] "2017-02-17T18:54:51.000Z"
## 
## $survey_house
## [1] "Gallup"
## 
## $mode
## [1] "Live Phone"
## 
## $url
## [1] "http://www.gallup.com/poll/201617/gallup-daily-trump-job-approval.aspx"
## 
## $partisanship
## [1] "Nonpartisan"
## 
## $partisan_affiliation
## [1] "None"
## 
## $poll_questions
## $poll_questions[[1]]
## $poll_questions[[1]]$text
## [1] ""
## 
## $poll_questions[[1]]$question
## $poll_questions[[1]]$question$slug
## [1] "00c -Pres-45-Trump - Job Approval - National"
## 
## $poll_questions[[1]]$question$name
## [1] "Trump, Donald - USPres - Job Approval"
## 
## $poll_questions[[1]]$question$tags
## list()
## 
## $poll_questions[[1]]$question$charts
## $poll_questions[[1]]$question$charts[[1]]
## [1] "trump-job-approval"
## 
## 
## $poll_questions[[1]]$question$election_date
## NULL
## 
## $poll_questions[[1]]$question$n_polls
## [1] 69
## 
## $poll_questions[[1]]$question$created_at
## [1] "2017-01-10T18:32:55.000Z"
## 
## $poll_questions[[1]]$question$responses
## $poll_questions[[1]]$question$responses[[1]]
## $poll_questions[[1]]$question$responses[[1]]$label
## [1] "Approve"
## 
## $poll_questions[[1]]$question$responses[[1]]$name
## [1] "Approve"
## 
## $poll_questions[[1]]$question$responses[[1]]$party
## NULL
## 
## $poll_questions[[1]]$question$responses[[1]]$incumbent
## [1] FALSE
## 
## 
## $poll_questions[[1]]$question$responses[[2]]
## $poll_questions[[1]]$question$responses[[2]]$label
## [1] "Disapprove"
## 
## $poll_questions[[1]]$question$responses[[2]]$name
## [1] "Disapprove"
## 
## $poll_questions[[1]]$question$responses[[2]]$party
## NULL
## 
## $poll_questions[[1]]$question$responses[[2]]$incumbent
## [1] FALSE
## 
## 
## $poll_questions[[1]]$question$responses[[3]]
## $poll_questions[[1]]$question$responses[[3]]$label
## [1] "Undecided"
## 
## $poll_questions[[1]]$question$responses[[3]]$name
## [1] "Undecided"
## 
## $poll_questions[[1]]$question$responses[[3]]$party
## NULL
## 
## $poll_questions[[1]]$question$responses[[3]]$incumbent
## [1] FALSE
## 
## 
## 
## 
## $poll_questions[[1]]$sample_subpopulations
## $poll_questions[[1]]$sample_subpopulations[[1]]
## $poll_questions[[1]]$sample_subpopulations[[1]]$name
## [1] "Adults"
## 
## $poll_questions[[1]]$sample_subpopulations[[1]]$observations
## [1] 1500
## 
## $poll_questions[[1]]$sample_subpopulations[[1]]$margin_of_error
## [1] 3
## 
## $poll_questions[[1]]$sample_subpopulations[[1]]$responses
## $poll_questions[[1]]$sample_subpopulations[[1]]$responses[[1]]
## $poll_questions[[1]]$sample_subpopulations[[1]]$responses[[1]]$text
## [1] "Approve"
## 
## $poll_questions[[1]]$sample_subpopulations[[1]]$responses[[1]]$pollster_label
## [1] "Approve"
## 
## $poll_questions[[1]]$sample_subpopulations[[1]]$responses[[1]]$value
## [1] 38
## 
## 
## $poll_questions[[1]]$sample_subpopulations[[1]]$responses[[2]]
## $poll_questions[[1]]$sample_subpopulations[[1]]$responses[[2]]$text
## [1] "Disapprove"
## 
## $poll_questions[[1]]$sample_subpopulations[[1]]$responses[[2]]$pollster_label
## [1] "Disapprove"
## 
## $poll_questions[[1]]$sample_subpopulations[[1]]$responses[[2]]$value
## [1] 56</code></pre>
</div>
<div id="tags" class="section level1">
<h1 class="hasAnchor">
<html><body><a href="#tags" class="anchor"> </a></body></html>Tags</h1>
<p>Get all available tags for use as the <code>tag</code> parameter with charts, polls, and questions:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">map_chr</span>(<span class="kw"><a href="../reference/pollster_api.html">pollster_tags</a></span>()$content, <span class="st">"slug"</span>)</code></pre></div>
<pre><code>##  [1] "2012-president-gop-primary" "2012-president"            
##  [3] "favorable-ratings"          "obama-job-approval"        
##  [5] "2012-senate"                "2012-house"                
##  [7] "2012-governor"              "2012-governor-dem-primary" 
##  [9] "2012-senate-dem-primary"    "2012-senate-gop-primary"   
## [11] "2012-governor-gop-primary"  "2014-house"                
## [13] "2013-governor"              "2013-senate"               
## [15] "2014-senate"                "2013-senate-dem-primary"   
## [17] "2014-governor"              "2016-president-gop-primary"
## [19] "2013-house"                 "2016-president-dem-primary"
## [21] "2013-senate-gop-primary"    "2016-president"            
## [23] "2014-senate-gop-primary"    "2014-senate-dem-primary"   
## [25] "2014-governor-dem-primary"  "2014-senate-primary"       
## [27] "2014-governor-gop-primary"  "2016-senate"               
## [29] "2016-governor"              "2016-senate-dem-primary"   
## [31] "2016-senate-gop-primary"    "2016-house"                
## [33] "uk-eu-referendum"           "2016-governor-dem-primary" 
## [35] "2016-governor-gop-primary"</code></pre>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#produce-a-plot-of-chart">Produce a Plot of Chart</a></li>
      <li><a href="#questions">Questions</a></li>
      <li><a href="#charts">Charts</a></li>
      <li><a href="#polls">Polls</a></li>
      <li><a href="#tags">Tags</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Jeffrey B. Arnold, Thomas J. Leeper, Drew Linzer.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  </body>
</html>
